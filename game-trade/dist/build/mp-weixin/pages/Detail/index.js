"use strict";var e=require("../../common/vendor.js"),t=require("../../store/index.js");if(require("../../store/user.js"),require("../../store/LeagueofLegend.js"),require("../../store/GenshinImpact.js"),require("../../store/GloryOfTheKing.js"),require("../../store/detail.js"),!Array){e.resolveComponent("uni-icons")()}const i=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||(e.unref(a)+i+e.unref(n))();const n=()=>"../../components/Options/index.js",a=()=>"../../components/Basic/index.js",o=e.defineComponent({__name:"index",setup(i){const n=t.useStore(),a=e.ref("游戏截图"),o=e.reactive({server:"",region:"",price:0,game:"",user_id:"",create_time:0,_id:"",materials:""}),s=e.reactive([{value:0,text:"游戏截图"},{value:1,text:"账号信息"},{value:2,text:"游戏交流群"}]),r=e.rn.database();e.onLoad((async e=>{o._id=e.id,await r.collection("consignment").where(`_id=='${e.id}'`).get({getOne:!0}).then((async e=>{Object.assign(o,e.result.data)})),c(),n.detail.getDetail(o)}));const c=async()=>{await r.collection("collect").where(`consignment_id=='${o._id}'&&user_id=='${d.value}'`).get({getOne:!0}).then((e=>{e.result.data?l.value=!0:l.value=!1})).catch((e=>{console.log(e)}))},l=e.ref(!1),{userId:d}=e.storeToRefs(n.user),u=async()=>{l.value?await r.collection("collect").where(`consignment_id=='${o._id}'&&user_id=='${d.value}'`).remove().then((async()=>{await c(),e.index.showToast({title:"取消收藏",icon:"none"})})):await r.collection("collect").add({consignment_id:o._id}).then((async()=>{await c(),e.index.showToast({title:"收藏成功"})}))},g=()=>{e.index.navigateTo({url:`/pages/Detail/Buy/index?id=${o._id}`})},v=()=>{e.index.navigateTo({url:"/pages/Message/Consult/index"})};return(t,i)=>({a:e.p({detail:o}),b:e.p({type:"right",size:"17",color:"#ccc"}),c:e.p({type:"right",size:"16",color:"#eaa24d"}),d:e.f(s,((t,i,o)=>({a:e.t(t.text),b:e.s(t.text==a.value?{fontWeight:900}:{color:"#ccc"}),c:t.value,d:e.o((e=>{return i=t.text,a.value=i,void n.detail.getCurrentOption(a.value);var i}),t.value)}))),e:o._id,f:e.p({option:a.value,game:o.game}),g:e.p({type:l.value?"star-filled":"star",size:"27"}),h:e.o(u),i:e.o(v),j:e.o(g)})}});var s=e._export_sfc(o,[["__scopeId","data-v-505d1586"]]);wx.createPage(s);
