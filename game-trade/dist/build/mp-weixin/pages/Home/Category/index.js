"use strict";var e=require("../../../common/vendor.js"),a=require("../../../store/index.js");if(require("../../../store/user.js"),require("../../../store/LeagueofLegend.js"),require("../../../store/GenshinImpact.js"),require("../../../store/detail.js"),!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js")+e.unref(u))();const u=()=>"../../../components/List/index.js",t=e.defineComponent({__name:"index",setup(u){const t=e.ref([{value:0,text:"500以下"},{value:1,text:"500-1000"},{value:2,text:"1000-3000"},{value:3,text:"3000-10000"},{value:4,text:"10000-30000"},{value:5,text:"30000以上"}]),l=e.ref([{value:0,text:"支持"},{value:1,text:"不支持"}]),r=e.ref(null),v=()=>{r.value.open()},o=a.useStore(),{email:c}=e.storeToRefs(o.GenshinImpact),{grading:s}=e.storeToRefs(o.LeagueofLegend),n=e.ref("原神"),i=e.ref(`game=='${n.value}'`),p=e.ref([]),f=e.ref([]),d=e.ref(""),m=e.ref(""),x=a=>{p.value.length=0;const u=e.storeToRefs(o[a]);u.allServer.value.forEach((e=>{p.value.push(...e)})),f.value=u.region.value.slice(0),0!=f.value.findIndex((e=>"全部"==e.text))&&f.value.unshift({value:999,text:"全部"})},h=()=>{d.value=f.value[0].text},b=e=>{"area"==e&&(d.value="全部",m.value=""),"screen"==e&&(A.value="",E.value="",R.value="")},g=a=>{const u=e.ref([]);u.value.push(`game=='${n.value}'`),"area"==a&&("全部"!=d.value&&u.value.push(`region=='${d.value}'`),m.value&&u.value.push(`server=='${m.value}'`),r.value.close()),"screen"==a&&("支持"==A.value&&u.value.push("materials=='提供'"),"不支持"==A.value&&u.value.push("materials=='不提供'"),E.value&&u.value.push(`email=='${E.value}'`),R.value&&u.value.push(`grading=='${R.value}'`),S.value&&u.value.push(T.value),z.value.close()),i.value=u.value.join("&&")},k=e.reactive([]),y=e.reactive([]),j=e.pn.database();e.onLoad((async()=>{await j.collection("category").orderBy("order","asc").get().then((e=>{k.push(...e.result.data.slice(0,4)),y.push(...e.result.data)})),x("GenshinImpact"),h()}));const L=e.ref(null),_=()=>{L.value.open("bottom")},w=()=>{L.value.close()},q=e.ref([{value:0,text:"默认排序"},{value:1,text:"最新发布"},{value:2,text:"价格最低"},{value:3,text:"价格最高"}]),I=e.ref(null),$=()=>{I.value.open()},G=e.ref("create_time desc"),z=e.ref(null),C=()=>{z.value.open()},A=e.ref(""),E=e.ref(""),R=e.ref(""),S=e.ref(""),T=e.ref("");return(a,u)=>e.e({a:e.f(k,((a,u,t)=>({a:a.icon,b:e.t(a.name),c:e.s(n.value==a.name?{fontWeight:900}:{color:"#a9a9a9"}),d:a.id,e:e.o((e=>(e=>{switch(n.value=e,i.value=`game=='${n.value}'`,e){case"原神":x("GenshinImpact");break;case"英雄联盟":x("LeagueofLegend")}h()})(a.name)),a.id)}))),b:e.o(_),c:e.o(w),d:e.p({type:"arrow-left",size:"30",color:"#1296db"}),e:e.f(y,((a,u,t)=>({a:a.icon,b:e.t(a.name),c:a.id,d:e.o((e=>(e=>{if(k[0].name==e.name)return;n.value=e.name,k.forEach(((a,u)=>{a.name==e.name&&(k.splice(u,1),k.unshift(e))})),-1==k.map((a=>a.name==e.name)).indexOf(!0)&&(k.pop(),k.unshift(e)),L.value.close()})(a)),a.id)}))),f:e.sr(L,"7cacf53e-0",{k:"popup"}),g:e.p({type:"bottom",safeArea:!1}),h:e.p({type:"bottom",size:"15",color:"#ccc"}),i:e.o(v),j:e.p({type:"bottom",size:"15",color:"#ccc"}),k:e.o($),l:e.p({type:"bars",size:"15",color:"#ccc"}),m:e.o(C),n:e.p({game:n.value,where:i.value,sort:G.value}),o:e.f(f.value,((a,u,t)=>({a:e.t(a.text),b:a.value,c:e.n(d.value==a.text?"active":""),d:e.o((u=>(a=>{d.value=a.text;const u=e.ref("");switch(n.value){case"原神":u.value="GenshinImpact";break;case"英雄联盟":u.value="LeagueofLegend"}const t=e.storeToRefs(o[u.value]),l=e.ref([]);t.allServer.value.forEach((e=>{l.value.push(...e)})),"全部"!=a.text?p.value=t.allServer.value[a.value]:p.value=l.value})(a)),a.value)}))),p:e.f(p.value,((a,u,t)=>({a:e.t(a.text),b:a.text,c:e.n(m.value==a.text?"active":""),d:e.o((e=>{return u=a.text,void(m.value=u);var u}),a.text)}))),q:e.o((e=>b("area"))),r:e.o((e=>g("area"))),s:e.sr(r,"7cacf53e-6",{k:"area"}),t:e.p({type:"right"}),v:e.f(q.value,((a,u,t)=>({a:e.t(a.text),b:a.value,c:e.o((e=>(e=>{switch(e){case 0:case 1:G.value="create_time desc";break;case 2:G.value="price asc";break;case 3:G.value="price desc"}I.value.close()})(a.value)),a.value)}))),w:e.sr(I,"7cacf53e-7",{k:"order"}),x:e.p({type:"bottom",safeArea:!1}),y:e.f(t.value,((a,u,l)=>({a:e.t(a.text),b:a.value,c:e.o((e=>(e=>{switch(S.value=t.value[e].text,e){case 0:T.value="price<500";break;case 1:T.value="price>=500&&price<1000";break;case 2:T.value="price>=1000&&price<3000";break;case 3:T.value="price>=3000&&price<10000";break;case 4:T.value="price>=10000&&price<30000";break;case 5:T.value="price>30000"}})(a.value)),a.value),d:e.n(S.value==a.text?"active":"")}))),z:e.f(l.value,((a,u,t)=>({a:e.t(a.text),b:a.value,c:e.o((e=>{return u=a.text,void(A.value=u);var u}),a.value),d:e.n(A.value==a.text?"active":"")}))),A:"英雄联盟"==n.value},"英雄联盟"==n.value?{B:e.f(e.unref(s),((a,u,t)=>({a:e.t(a.text),b:a.value,c:e.o((e=>{return u=a.text,void(R.value=u);var u}),a.value),d:e.n(R.value==a.text?"active":"")})))}:{},{C:"原神"==n.value},"原神"==n.value?{D:e.f(e.unref(c),((a,u,t)=>({a:e.t(a.text),b:a.value,c:e.n(E.value==a.text?"active":""),d:e.o((e=>{return u=a.text,void(E.value=u);var u}),a.value)})))}:{},{E:e.o((e=>b("screen"))),F:e.o((e=>g("screen"))),G:e.sr(z,"7cacf53e-8",{k:"screen"}),H:e.p({type:"right"})})}});var l=e._export_sfc(t,[["__scopeId","data-v-7cacf53e"]]);wx.createComponent(l);
