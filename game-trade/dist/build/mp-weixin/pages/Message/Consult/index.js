"use strict";var e=require("../../../common/vendor.js"),a=require("../../../store/index.js");if(require("../../../store/user.js"),require("../../../store/LeagueofLegend.js"),require("../../../store/GenshinImpact.js"),require("../../../store/GloryOfTheKing.js"),require("../../../store/detail.js"),!Array){e.resolveComponent("uni-dateformat")()}Math;const r=e.defineComponent({__name:"index",setup(r){const t=a.useStore(),{userId:o,userInfo:s}=e.storeToRefs(t.user),n=e.ref(),u=e.ref(),i=e.ref("1250rpx"),l=()=>{i.value="950rpx"},d=e.ref([]),c=async()=>{await v.collection("consult").where(`user_id=='${o.value}'`).orderBy("create_time","desc").get().then((e=>{d.value=e.result.data.reverse()}))};e.onLoad((async()=>{await c(),u.value="msg"+d.value[d.value.length-1]._id}));const v=e.rn.database(),f=async()=>{n.value?(await v.collection("consult").add({content:n.value}),await c(),u.value="msg"+d.value[d.value.length-1]._id,e.index.showToast({title:"发送成功",icon:"none"}),n.value="",i.value="1250rpx"):e.index.showToast({title:"聊天的内容不能为空!",icon:"none"})};return(a,r)=>({a:e.f(d.value,((a,r,t)=>({a:"195b2a84-0-"+t,b:e.p({date:a.create_time,format:"yyyy-MM-dd hh:mm"}),c:e.t(a.content),d:a._id,e:"msg"+a._id}))),b:e.unref(s).avatar_file.url,c:u.value,d:i.value,e:e.o(l),f:n.value,g:e.o((e=>n.value=e.detail.value)),h:e.o(f)})}});var t=e._export_sfc(r,[["__scopeId","data-v-195b2a84"]]);wx.createPage(t);
