"use strict";var e=require("../common/vendor.js");const a=e.defineStore({id:"user",state:()=>({userInfo:{},balance:0}),actions:{async getUserInfo(){const a=e.rn.database();await a.collection("uni-id-users").where("_id==$cloudEnv_uid").field("_id,nickname,avatar_file,register_date,balance,phone").get({getOne:!0}).then((e=>{Object.assign(this.userInfo,e.result.data)})).catch((()=>{e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd?type=weixin"})}))},async getBalance(){const a=e.rn.database();await a.collection("balance").where(`user_id=='${this.userId}'`).get().then((e=>{this.balance=0,e.result.data.forEach((e=>{this.balance+=e.money}))}))}},getters:{userId:e=>e.userInfo._id}});exports.useUser=a;
